angular.module("App").directive("codeEditor",function(){return{restrict:"E",scope:{options:"=",model:"=",field:"@",mode:"@"},templateUrl:ENV.rootPath+"/partials/code-editor.html",link:function(scope,el,attrs){scope.aceOptions=scope.options||{},scope.$watch("mode",function(){var mode=scope.mode;"node"===mode&&(mode="javascript"),scope.aceOptions.mode=mode}),scope.aceOptions.onLoad=function(editor){editor.$blockScrolling=1/0}}}}),angular.module("App").directive("dropSearch",function(){return{restrict:"E",scope:{items:"=",label:"=?",value:"=?",initial:"=?",ngModel:"=?",onChoose:"=?",nullLabel:"@"},templateUrl:ENV.rootPath+"/partials/drop-search.html",link:function(scope,el,attrs){scope.onChoose=scope.onChoose||function(){},attrs.ngModel?scope.$watch("ngModel",function(){scope.chosen=scope.items.filter(function(i){return scope.ngModel===scope.getValue(i)})[0]}):scope.$watch("initial",function(){scope.chosen=scope.initial}),scope.$watch("chosen",function(){scope.ngModel=scope.getValue(scope.chosen)}),scope.getValue=function(item){return"function"==typeof scope.value?scope.value(item):scope.value&&item?item[scope.value]:item},scope.getLabel=function(item){return"function"==typeof scope.label?scope.label(item):scope.label&&item?item[scope.label]:item}}}}),angular.module("App").directive("operationTitle",function(){return{restrict:"E",scope:{operation:"=",showId:"=",showSummary:"="},templateUrl:ENV.rootPath+"/partials/operation-title.html",link:function(scope,el,attrs){}}}),angular.module("App").directive("parameter",function(){return{restrict:"E",scope:{parameter:"=parameter",model:"=model"},templateUrl:ENV.rootPath+"/partials/parameter.html",link:function(scope,el,attrs){}}}),angular.module("App").directive("schemaDisplay",function(){return{restrict:"E",scope:{schema:"=",examples:"=",derefBase:"="},templateUrl:ENV.rootPath+"/partials/schema-display.html",link:function(scope,el,attrs){scope.schemaView="schema",scope.MAX_HIGHLIGHT_LEN=1e4,scope.$watch("schema",function(){scope.schemaDeref=scope.derefBase?window.dereference(scope.derefBase,JSON.parse(JSON.stringify(scope.schema))):scope.schema,scope.examples&&scope.examples["application/json"]?scope.exampleString=JSON.stringify(scope.examples["application/json"],null,2):scope.exampleString=JSON.stringify(EXAMPLES.schemaExample(scope.schemaDeref),null,2)})}}}),angular.module("App").directive("sidebarButton",function(){return{restrict:"E",scope:{open:"=",menuItems:"=",prefix:"="},template:'<a ng-click="open = !open" ng-class="open ? \'sidebar-button-fixed\' : \'\'" class="btn btn-lg btn-primary sidebar-button"><i ng-class="{\'fa-bars\': !open, \'fa-times\': open}" class="fa sidebar-status"></i><b ng-bind="prefix" class="hidden-xs"></b><span ng-show="prefix &amp;&amp; menuItems.active" class="hidden-xs"> - </span><span ng-bind="menuItems.active.title"></span></a>'}}),angular.module("App").directive("sidebar",["$location",function(location){return{restrict:"E",transclude:!0,scope:{menuItems:"=menuItems",open:"=open"},templateUrl:ENV.rootPath+"/partials/sidebar.html",link:function(scope,el,attrs){function setDefaults(item){item.title=item.title||"Untitled",item.searchText=item.searchText||item.title.toLowerCase(),item.hash=item.hash||"/"+item.title,item.children&&item.children.forEach(setDefaults)}function showSidebarItem(item,terms){if(item.hidden)return!1;if("string"==typeof terms)return showSidebarItem(item,terms.toLowerCase().split(" "));var termHits=terms.filter(function(t){return-1!==item.searchText.indexOf(t)});return termHits.length===terms.length?!0:(item.children||[]).filter(function(c){return showSidebarItem(c,terms)}).length}scope.menuItems.forEach(setDefaults),scope.$watch("menuItems.active",function(){scope.menuItems.active||(scope.menuItems.active=scope.menuItems[0]);var item=scope.menuItems.active;item&&location.path(item.hash)}),scope.showSidebarItem=function(item){return showSidebarItem(item,scope.query||"")},scope.isOpen=function(item){return scope.menuItems.active===item?!0:(item.children||[]).filter(scope.isOpen).length},scope.toggleActive=function(item){scope.menuItems.active=item}}}}]).controller("SidebarItem",function($scope){$scope.sidebarItem=$scope.grandchild||$scope.child||$scope.item,$scope.$watch("menuItems.active",function(){$scope.open=$scope.isOpen($scope.sidebarItem)})}),angular.module("App").directive("tagInput",function(){return{restrict:"E",scope:{tags:"=tags"},templateUrl:ENV.rootPath+"/partials/tag-input.html",link:function(scope,el,attrs){scope.tags=scope.tags||[],scope.tagString=scope.tags.join(", "),scope.$watch("tagString",function(){scope.tags=scope.tagString.split(",").map(function(t){return t.trim()}).filter(function(t){return t})})}}});